<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.4"/>
<title>Rendering and Animation Platform: src/Animation/ParticleSystem.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Rendering and Animation Platform
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.4 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_d0530f5a118c67448463a7f9eabe8fdd.html">Animation</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">ParticleSystem.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="_particle_system_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#ifndef _Animation_ParticleSystem_H</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define _Animation_ParticleSystem_H</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="_particle_8h.html">Animation/Particle.h</a>&gt;</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="_sampler_8h.html">Math/Sampler.h</a>&gt;</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#include &lt;vector&gt;</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include &lt;functional&gt;</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &lt;iterator&gt;</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#include &lt;tbb/parallel_for_each.h&gt;</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &lt;algorithm&gt;</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="keyword">namespace </span>Animation</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;{</div>
<div class="line"><a name="l00022"></a><span class="lineno"><a class="code" href="class_animation_1_1_particle_system.html">   22</a></span>&#160;    <span class="keyword">class </span><a class="code" href="class_animation_1_1_particle_system.html" title="A particle system with a programmable behavior. ">ParticleSystem</a></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    {</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    <span class="keyword">public</span>:</div>
<div class="line"><a name="l00030"></a><span class="lineno"><a class="code" href="class_animation_1_1_particle_system.html#a52cb920384a4da3484b376bd9f94efb0">   30</a></span>&#160;        typedef ::std::back_insert_iterator&lt;::std::vector&lt;Particle&gt;&gt; <a class="code" href="class_animation_1_1_particle_system.html#a52cb920384a4da3484b376bd9f94efb0">ParticleInserter</a> ;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    <span class="keyword">protected</span>:</div>
<div class="line"><a name="l00034"></a><span class="lineno"><a class="code" href="class_animation_1_1_particle_system.html#aca054fbe1acf27460894da8cd0d8a7f4">   34</a></span>&#160;        ::std::vector&lt;Particle&gt; <a class="code" href="class_animation_1_1_particle_system.html#aca054fbe1acf27460894da8cd0d8a7f4" title="The particles. ">m_particles</a> ;</div>
<div class="line"><a name="l00036"></a><span class="lineno"><a class="code" href="class_animation_1_1_particle_system.html#a03d1cbd820f5b138b97447a7ebde66fc">   36</a></span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="class_animation_1_1_particle_system.html#a03d1cbd820f5b138b97447a7ebde66fc" title="The particle budget. ">m_budget</a> ;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;        </div>
<div class="line"><a name="l00039"></a><span class="lineno"><a class="code" href="class_animation_1_1_particle_system.html#a2ed7371460c1ab2b9c032ec2dd84b490">   39</a></span>&#160;        ::std::vector&lt;::std::function&lt;void (float dt)&gt;&gt; <a class="code" href="class_animation_1_1_particle_system.html#a2ed7371460c1ab2b9c032ec2dd84b490" title="The modifiers applied to particles. ">m_modifiers</a>;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;</div>
<div class="line"><a name="l00042"></a><span class="lineno"><a class="code" href="class_animation_1_1_particle_system.html#a95961043ff5f7fabcf49d82ee4f0c8d3">   42</a></span>&#160;        ::std::vector&lt;::std::function&lt;void (::std::vector&lt;size_t&gt; &amp;)&gt;&gt; <a class="code" href="class_animation_1_1_particle_system.html#a95961043ff5f7fabcf49d82ee4f0c8d3" title="Death functions used to control life and death of the particles. ">m_deathQualifier</a> ;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div>
<div class="line"><a name="l00045"></a><span class="lineno"><a class="code" href="class_animation_1_1_particle_system.html#a67c364af17351a7fe8a2273556e6bd18">   45</a></span>&#160;        ::std::vector&lt;::std::function&lt;bool (ParticleInserter inserter, size_t productionLimit, float dt)&gt;&gt; <a class="code" href="class_animation_1_1_particle_system.html#a67c364af17351a7fe8a2273556e6bd18" title="The referenced particles emitters. ">m_emitters</a> ;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <span class="keyword">public</span>:</div>
<div class="line"><a name="l00052"></a><span class="lineno"><a class="code" href="class_animation_1_1_particle_system.html#a1ca9856d935b89a5475d7d6266357da8">   52</a></span>&#160;        <a class="code" href="class_animation_1_1_particle_system.html#a1ca9856d935b89a5475d7d6266357da8" title="Initializes a new instance of the ParticleSystem class. ">ParticleSystem</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="class_animation_1_1_particle_system.html#aa31a1ad45e76b5fc8bd28b3ad71de896" title="Gets the particle budget. ">budget</a>)</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;            : <a class="code" href="class_animation_1_1_particle_system.html#a03d1cbd820f5b138b97447a7ebde66fc" title="The particle budget. ">m_budget</a>(budget)</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        {}</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;</div>
<div class="line"><a name="l00066"></a><span class="lineno"><a class="code" href="class_animation_1_1_particle_system.html#a6bfc78221095d2ce7d7c23a7917efb25">   66</a></span>&#160;        const ::std::vector&lt;Particle&gt; &amp; <a class="code" href="class_animation_1_1_particle_system.html#a6bfc78221095d2ce7d7c23a7917efb25" title="Gets the particles (read only). ">getParticles</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="keyword">        </span>{</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="class_animation_1_1_particle_system.html#aca054fbe1acf27460894da8cd0d8a7f4" title="The particles. ">m_particles</a> ;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        }</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        <span class="keyword">template</span> &lt;<span class="keyword">class</span> ParticleModifier&gt;</div>
<div class="line"><a name="l00083"></a><span class="lineno"><a class="code" href="class_animation_1_1_particle_system.html#ac55779d6a4ec0233378e58cbd98be12c">   83</a></span>&#160;        <span class="keywordtype">void</span> <a class="code" href="class_animation_1_1_particle_system.html#ac55779d6a4ec0233378e58cbd98be12c" title="Adds a modifier. A modifier MUST be a functor which type is : void (Particle &amp;, float) ...">addModifier</a>(ParticleModifier modifier)</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        {</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;            <span class="keyword">auto</span> func = [<span class="keyword">this</span>, modifier](<span class="keywordtype">float</span> dt) </div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;                { </div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;                    <span class="keywordflow">for</span>(<span class="keyword">auto</span> it=<a class="code" href="class_animation_1_1_particle_system.html#aca054fbe1acf27460894da8cd0d8a7f4" title="The particles. ">m_particles</a>.begin() ; it!=<a class="code" href="class_animation_1_1_particle_system.html#aca054fbe1acf27460894da8cd0d8a7f4" title="The particles. ">m_particles</a>.end() ; ++it)</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;                    {</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;                        modifier(*it, dt) ;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;                    }</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;                } ;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;            <span class="comment">//auto func = [this, modifier](float dt) </span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;            <span class="comment">//{ </span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;            <span class="comment">//  auto &amp; refModifier = modifier ;</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;            <span class="comment">//  auto subFunction = [&amp;dt, refModifier](Particle &amp; particle) { refModifier(particle, dt); } ;</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;            <span class="comment">//  ::tbb::parallel_for_each(m_particles.begin(), m_particles.end(), subFunction) ;</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;            <span class="comment">//} ; </span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;            <a class="code" href="class_animation_1_1_particle_system.html#a2ed7371460c1ab2b9c032ec2dd84b490" title="The modifiers applied to particles. ">m_modifiers</a>.push_back(func) ;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        }</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        <span class="keyword">template</span> &lt;<span class="keyword">class</span> DeathFunction&gt;</div>
<div class="line"><a name="l00114"></a><span class="lineno"><a class="code" href="class_animation_1_1_particle_system.html#a080cd19b122ca5ff04d14bd50447bef3">  114</a></span>&#160;        <span class="keywordtype">void</span> <a class="code" href="class_animation_1_1_particle_system.html#a080cd19b122ca5ff04d14bd50447bef3" title="Adds a death function to the particle system. deathFunction MUST be a functor which type is: bool (co...">addDeathFunction</a>(DeathFunction deathFunction)</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        {</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;            <span class="keyword">auto</span> func = [<span class="keyword">this</span>, deathFunction] (::std::vector&lt;size_t&gt; &amp; deadVector) -&gt; <span class="keywordtype">void</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;                {</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                    <span class="keywordflow">for</span>(<span class="keyword">auto</span> it=<a class="code" href="class_animation_1_1_particle_system.html#aca054fbe1acf27460894da8cd0d8a7f4" title="The particles. ">m_particles</a>.begin() ; it!=<a class="code" href="class_animation_1_1_particle_system.html#aca054fbe1acf27460894da8cd0d8a7f4" title="The particles. ">m_particles</a>.end() ; ++it)</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                    {</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;                        <span class="keywordtype">bool</span> dead = deathFunction(*it) ;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;                        <span class="keywordflow">if</span>(dead) { deadVector.push_back(it-<a class="code" href="class_animation_1_1_particle_system.html#aca054fbe1acf27460894da8cd0d8a7f4" title="The particles. ">m_particles</a>.begin()) ; }</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;                    }</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;                } ;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;            <a class="code" href="class_animation_1_1_particle_system.html#a95961043ff5f7fabcf49d82ee4f0c8d3" title="Death functions used to control life and death of the particles. ">m_deathQualifier</a>.push_back(func) ;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        }</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        <span class="keyword">template</span> &lt;<span class="keyword">class</span> EmitterFunction&gt;</div>
<div class="line"><a name="l00148"></a><span class="lineno"><a class="code" href="class_animation_1_1_particle_system.html#a92534e5c03dd93643a3133df019fb36a">  148</a></span>&#160;        <span class="keywordtype">void</span> <a class="code" href="class_animation_1_1_particle_system.html#a92534e5c03dd93643a3133df019fb36a" title="Adds an emitter to the particle system. ">addEmitter</a>(EmitterFunction emitter)</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        {</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;            <a class="code" href="class_animation_1_1_particle_system.html#a67c364af17351a7fe8a2273556e6bd18" title="The referenced particles emitters. ">m_emitters</a>.push_back(emitter) ;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        }</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;</div>
<div class="line"><a name="l00163"></a><span class="lineno"><a class="code" href="class_animation_1_1_particle_system.html#aa31a1ad45e76b5fc8bd28b3ad71de896">  163</a></span>&#160;        <span class="keywordtype">size_t</span> <a class="code" href="class_animation_1_1_particle_system.html#aa31a1ad45e76b5fc8bd28b3ad71de896" title="Gets the particle budget. ">budget</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="keyword">        </span>{</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="class_animation_1_1_particle_system.html#a03d1cbd820f5b138b97447a7ebde66fc" title="The particle budget. ">m_budget</a> ;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        }</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;</div>
<div class="line"><a name="l00178"></a><span class="lineno"><a class="code" href="class_animation_1_1_particle_system.html#a6ff0b48c026ecef87cc55e23729295e2">  178</a></span>&#160;        <span class="keywordtype">void</span> <a class="code" href="class_animation_1_1_particle_system.html#a6ff0b48c026ecef87cc55e23729295e2" title="Updates the particle system. ">update</a>(<span class="keywordtype">float</span> dt)</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        {</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;            <span class="comment">// Evolution of the particles</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;            <span class="keywordflow">for</span>(<span class="keyword">auto</span> it=<a class="code" href="class_animation_1_1_particle_system.html#a2ed7371460c1ab2b9c032ec2dd84b490" title="The modifiers applied to particles. ">m_modifiers</a>.begin(); it!=<a class="code" href="class_animation_1_1_particle_system.html#a2ed7371460c1ab2b9c032ec2dd84b490" title="The modifiers applied to particles. ">m_modifiers</a>.end() ; ++it)</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;            {</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;                (*it)(dt) ;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;            }</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;            <span class="comment">// Life and death</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;            ::std::vector&lt;size_t&gt; deathVector ;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;            <span class="keywordflow">for</span>(<span class="keyword">auto</span> it=<a class="code" href="class_animation_1_1_particle_system.html#a95961043ff5f7fabcf49d82ee4f0c8d3" title="Death functions used to control life and death of the particles. ">m_deathQualifier</a>.begin() ; it!=<a class="code" href="class_animation_1_1_particle_system.html#a95961043ff5f7fabcf49d82ee4f0c8d3" title="Death functions used to control life and death of the particles. ">m_deathQualifier</a>.end() ; ++it)</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;            {</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;                (*it)(deathVector) ; <span class="comment">// Note that death vector is sorted in increasing order (consequence of the algorithm)</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                <span class="keywordflow">for</span>(<span class="keyword">auto</span> itDeath = deathVector.rbegin() ; itDeath!=deathVector.rend() ; ++itDeath)</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;                {</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;                    <a class="code" href="class_animation_1_1_particle_system.html#aca054fbe1acf27460894da8cd0d8a7f4" title="The particles. ">m_particles</a>[*itDeath] = <a class="code" href="class_animation_1_1_particle_system.html#aca054fbe1acf27460894da8cd0d8a7f4" title="The particles. ">m_particles</a>.back() ; </div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                    <a class="code" href="class_animation_1_1_particle_system.html#aca054fbe1acf27460894da8cd0d8a7f4" title="The particles. ">m_particles</a>.pop_back() ;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                }</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                deathVector.erase(deathVector.begin(), deathVector.end()) ;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;            }</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;            <span class="comment">// Emission</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;            <span class="keywordflow">for</span>(<span class="keyword">auto</span> it=<a class="code" href="class_animation_1_1_particle_system.html#a67c364af17351a7fe8a2273556e6bd18" title="The referenced particles emitters. ">m_emitters</a>.begin() ; it!=<a class="code" href="class_animation_1_1_particle_system.html#a67c364af17351a7fe8a2273556e6bd18" title="The referenced particles emitters. ">m_emitters</a>.end() ; ++it)</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;            {</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;                (*it)(::std::back_inserter(<a class="code" href="class_animation_1_1_particle_system.html#aca054fbe1acf27460894da8cd0d8a7f4" title="The particles. ">m_particles</a>), <a class="code" href="class_animation_1_1_particle_system.html#a03d1cbd820f5b138b97447a7ebde66fc" title="The particle budget. ">m_budget</a>-<a class="code" href="class_animation_1_1_particle_system.html#aca054fbe1acf27460894da8cd0d8a7f4" title="The particles. ">m_particles</a>.size(), dt) ;</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;                <span class="keywordflow">if</span>(<a class="code" href="class_animation_1_1_particle_system.html#aca054fbe1acf27460894da8cd0d8a7f4" title="The particles. ">m_particles</a>.size()&gt;<a class="code" href="class_animation_1_1_particle_system.html#a03d1cbd820f5b138b97447a7ebde66fc" title="The particle budget. ">m_budget</a>) <span class="comment">// We enforce the budget</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;                {</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;                    <a class="code" href="class_animation_1_1_particle_system.html#aca054fbe1acf27460894da8cd0d8a7f4" title="The particles. ">m_particles</a>.erase(<a class="code" href="class_animation_1_1_particle_system.html#aca054fbe1acf27460894da8cd0d8a7f4" title="The particles. ">m_particles</a>.begin()+<a class="code" href="class_animation_1_1_particle_system.html#a03d1cbd820f5b138b97447a7ebde66fc" title="The particle budget. ">m_budget</a>, <a class="code" href="class_animation_1_1_particle_system.html#aca054fbe1acf27460894da8cd0d8a7f4" title="The particles. ">m_particles</a>.end()) ;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;                }</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;            }</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        }</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        <span class="comment">// -----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        <span class="comment">// Some modifiers (compatibles with the addModifier method)</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        <span class="comment">// -----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;</div>
<div class="line"><a name="l00224"></a><span class="lineno"><a class="code" href="class_animation_1_1_particle_system.html#a27d49dfdcb0c73a4cf09e044a6cd3e24">  224</a></span>&#160;        <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="class_animation_1_1_particle_system.html#a27d49dfdcb0c73a4cf09e044a6cd3e24" title="Modifier that resets forces applied on a particle. ">modifierResetForce</a>(<a class="code" href="class_animation_1_1_particle.html" title="Particle class. ">Particle</a> &amp; particle, <span class="keywordtype">float</span> dt)</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        {</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;            particle.<a class="code" href="class_animation_1_1_particle.html#aa47f369a116295efbd729d108012d2fb" title="The forces applied to the particle. ">m_forces</a> = <a class="code" href="namespace_math.html#a70970dd1ebbb9cd76df67a37db013e29" title="Makes a 2D vector. ">Math::makeVector</a>(0.0f,0.0f,0.0f) ;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        }</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;</div>
<div class="line"><a name="l00240"></a><span class="lineno"><a class="code" href="class_animation_1_1_particle_system.html#a869f286824f029c5ff89d3f535c29963">  240</a></span>&#160;        <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="class_animation_1_1_particle_system.html#a869f286824f029c5ff89d3f535c29963" title="Modifier that increases the life time. ">modifierLifeTime</a>(<a class="code" href="class_animation_1_1_particle.html" title="Particle class. ">Particle</a> &amp; particle, <span class="keywordtype">float</span> dt)</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;        {</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;            particle.<a class="code" href="class_animation_1_1_particle.html#ae2e814a41aa28b537e979617a5c956c3" title="The time elapsed since the birth of the particle. ">m_lifeTime</a>+=dt ;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        }</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;</div>
<div class="line"><a name="l00256"></a><span class="lineno"><a class="code" href="class_animation_1_1_particle_system.html#ac63a481b8dfe96598073928137ef5bb1">  256</a></span>&#160;        <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="class_animation_1_1_particle_system.html#ac63a481b8dfe96598073928137ef5bb1" title="Modifier that adds a weight force on the particle. ">modifierWeightForce</a>(<a class="code" href="class_animation_1_1_particle.html" title="Particle class. ">Particle</a> &amp; particle, <span class="keywordtype">float</span> dt)</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        {</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">float</span> gravity = 9.8f ;</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;            particle.<a class="code" href="class_animation_1_1_particle.html#aa47f369a116295efbd729d108012d2fb" title="The forces applied to the particle. ">m_forces</a> = particle.<a class="code" href="class_animation_1_1_particle.html#aa47f369a116295efbd729d108012d2fb" title="The forces applied to the particle. ">m_forces</a> + <a class="code" href="namespace_math.html#a70970dd1ebbb9cd76df67a37db013e29" title="Makes a 2D vector. ">Math::makeVector</a>(0.0f,0.0f,particle.<a class="code" href="class_animation_1_1_particle.html#ac15a0558257267c2eae7182affc581e8" title="The mass of the particle. ">m_mass</a> * gravity) ;</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        }</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;</div>
<div class="line"><a name="l00273"></a><span class="lineno"><a class="code" href="class_animation_1_1_particle_system.html#a5f71c9e06830864ee19568df5eb3f25b">  273</a></span>&#160;        <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="class_animation_1_1_particle_system.html#a5f71c9e06830864ee19568df5eb3f25b" title="Modifier that integrates force and speed to produce particle movements. ">modifierIntegrator</a>(<a class="code" href="class_animation_1_1_particle.html" title="Particle class. ">Particle</a> &amp; particle, <span class="keywordtype">float</span> dt)</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        {</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;            particle.<a class="code" href="class_animation_1_1_particle.html#a3642d8ff1ec3dbfa5afb4c86636375c1" title="The speed of the particle. ">m_speed</a> = particle.<a class="code" href="class_animation_1_1_particle.html#a3642d8ff1ec3dbfa5afb4c86636375c1" title="The speed of the particle. ">m_speed</a> + particle.<a class="code" href="class_animation_1_1_particle.html#aa47f369a116295efbd729d108012d2fb" title="The forces applied to the particle. ">m_forces</a>*dt/particle.<a class="code" href="class_animation_1_1_particle.html#ac15a0558257267c2eae7182affc581e8" title="The mass of the particle. ">m_mass</a> ;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;            particle.<a class="code" href="class_animation_1_1_particle.html#a077543117f298541ec4c01ccfa99c275" title="The position of the particle. ">m_position</a> = particle.<a class="code" href="class_animation_1_1_particle.html#a077543117f298541ec4c01ccfa99c275" title="The position of the particle. ">m_position</a> + particle.<a class="code" href="class_animation_1_1_particle.html#a3642d8ff1ec3dbfa5afb4c86636375c1" title="The speed of the particle. ">m_speed</a>*dt ;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        }</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;</div>
<div class="line"><a name="l00287"></a><span class="lineno"><a class="code" href="class_animation_1_1_particle_system_1_1_modifier_attractor.html">  287</a></span>&#160;        <span class="keyword">class </span><a class="code" href="class_animation_1_1_particle_system_1_1_modifier_attractor.html" title="Attractor class for particles. ">ModifierAttractor</a></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;        {</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;        <span class="keyword">private</span>:</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;            <a class="code" href="class_math_1_1_vector.html">Math::Vector3f</a> m_center ;</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;            <span class="keywordtype">float</span> m_extent ;</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;            <span class="keywordtype">float</span> m_attractionForce ;</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        <span class="keyword">public</span>:</div>
<div class="line"><a name="l00295"></a><span class="lineno"><a class="code" href="class_animation_1_1_particle_system_1_1_modifier_attractor.html#af908084838cd8feea2024ffcfb5ebb31">  295</a></span>&#160;            <a class="code" href="class_animation_1_1_particle_system_1_1_modifier_attractor.html#af908084838cd8feea2024ffcfb5ebb31">ModifierAttractor</a>(<span class="keyword">const</span> <a class="code" href="class_math_1_1_vector.html">Math::Vector3f</a> &amp; center, <span class="keywordtype">float</span> extent, <span class="keywordtype">float</span> attractionForce)</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;                : m_center(center), m_extent(extent), m_attractionForce(attractionForce)</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;            {}</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;</div>
<div class="line"><a name="l00299"></a><span class="lineno"><a class="code" href="class_animation_1_1_particle_system_1_1_modifier_attractor.html#a27a56af9aa3bbe7e92d4489c742fde6f">  299</a></span>&#160;            <span class="keywordtype">void</span> <a class="code" href="class_animation_1_1_particle_system_1_1_modifier_attractor.html#a27a56af9aa3bbe7e92d4489c742fde6f">operator() </a>(<a class="code" href="class_animation_1_1_particle.html" title="Particle class. ">Particle</a> &amp; particle, <span class="keywordtype">float</span> dt)<span class="keyword"> const</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="keyword">            </span>{</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;                <a class="code" href="class_math_1_1_vector.html">Math::Vector3f</a> delta = m_center-particle.<a class="code" href="class_animation_1_1_particle.html#a077543117f298541ec4c01ccfa99c275" title="The position of the particle. ">m_position</a> ;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;                <span class="keywordtype">float</span> deltaNorm = delta.<a class="code" href="class_math_1_1_vector.html#aa900b794c7ea6619460f074084f8cece" title="Return the norm of the vector. ">norm</a>() ;</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                <span class="keywordflow">if</span>(deltaNorm&lt;m_extent)</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;                {</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;                    <span class="keywordtype">float</span> t = deltaNorm/m_extent ;</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;                    <a class="code" href="class_math_1_1_vector.html">Math::Vector3f</a> force = delta.<a class="code" href="class_math_1_1_vector.html#a5a27a18c93ebe70f2975d9671eb3e1ee" title="Return the associated normalized vector. ">normalized</a>()*t*m_attractionForce ;</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;                    particle.<a class="code" href="class_animation_1_1_particle.html#aa47f369a116295efbd729d108012d2fb" title="The forces applied to the particle. ">m_forces</a> = particle.<a class="code" href="class_animation_1_1_particle.html#aa47f369a116295efbd729d108012d2fb" title="The forces applied to the particle. ">m_forces</a> + force ;</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;                }</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;            }</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        };</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;</div>
<div class="line"><a name="l00321"></a><span class="lineno"><a class="code" href="class_animation_1_1_particle_system_1_1_modifier_color_life_time.html">  321</a></span>&#160;        <span class="keyword">class </span><a class="code" href="class_animation_1_1_particle_system_1_1_modifier_color_life_time.html">ModifierColorLifeTime</a></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;        {</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;        <span class="keyword">protected</span>:</div>
<div class="line"><a name="l00324"></a><span class="lineno"><a class="code" href="class_animation_1_1_particle_system_1_1_modifier_color_life_time.html#ad10f3aaa39ffc15fb505043d912f0031">  324</a></span>&#160;            <a class="code" href="class_helper_gl_1_1_color.html" title="RGBA color. ">HelperGl::Color</a> <a class="code" href="class_animation_1_1_particle_system_1_1_modifier_color_life_time.html#ad10f3aaa39ffc15fb505043d912f0031">m_startColor</a> ;</div>
<div class="line"><a name="l00325"></a><span class="lineno"><a class="code" href="class_animation_1_1_particle_system_1_1_modifier_color_life_time.html#a658e4ad5801cc8f12dd591212db590db">  325</a></span>&#160;            <a class="code" href="class_helper_gl_1_1_color.html" title="RGBA color. ">HelperGl::Color</a> <a class="code" href="class_animation_1_1_particle_system_1_1_modifier_color_life_time.html#a658e4ad5801cc8f12dd591212db590db">m_endColor</a> ;</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        <span class="keyword">public</span>:</div>
<div class="line"><a name="l00328"></a><span class="lineno"><a class="code" href="class_animation_1_1_particle_system_1_1_modifier_color_life_time.html#a686792f5d0f2eab075ce8ab6b2939694">  328</a></span>&#160;            <a class="code" href="class_animation_1_1_particle_system_1_1_modifier_color_life_time.html#a686792f5d0f2eab075ce8ab6b2939694">ModifierColorLifeTime</a>(<a class="code" href="class_helper_gl_1_1_color.html" title="RGBA color. ">HelperGl::Color</a> <span class="keyword">const</span> &amp; start, <a class="code" href="class_helper_gl_1_1_color.html" title="RGBA color. ">HelperGl::Color</a> <span class="keyword">const</span> &amp; end)</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;                : <a class="code" href="class_animation_1_1_particle_system_1_1_modifier_color_life_time.html#ad10f3aaa39ffc15fb505043d912f0031">m_startColor</a>(start), <a class="code" href="class_animation_1_1_particle_system_1_1_modifier_color_life_time.html#a658e4ad5801cc8f12dd591212db590db">m_endColor</a>(end)</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;            {}</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;</div>
<div class="line"><a name="l00332"></a><span class="lineno"><a class="code" href="class_animation_1_1_particle_system_1_1_modifier_color_life_time.html#a575145510473a4133b416c89242ff014">  332</a></span>&#160;            <span class="keywordtype">void</span> <a class="code" href="class_animation_1_1_particle_system_1_1_modifier_color_life_time.html#a575145510473a4133b416c89242ff014">operator() </a>(<a class="code" href="class_animation_1_1_particle.html" title="Particle class. ">Particle</a> &amp; particle, <span class="keywordtype">float</span> dt)<span class="keyword"> const</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="keyword">            </span>{</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;                <span class="keywordtype">float</span> timePercent = ::std::min(particle.<a class="code" href="class_animation_1_1_particle.html#ae2e814a41aa28b537e979617a5c956c3" title="The time elapsed since the birth of the particle. ">m_lifeTime</a>/particle.<a class="code" href="class_animation_1_1_particle.html#ad5e599c37c42c2b7febb28d9d0b3801e" title="The life time limit of the particle. ">m_lifeTimeLimit</a>, 1.0f) ;</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;                particle.<a class="code" href="class_animation_1_1_particle.html#a2844d1cf6660bedaca4e5afdd1a68987" title="The color of the particle. ">m_color</a> = <a class="code" href="namespace_helper_gl.html#a2ffacc1e1fda6572b28d9aae8ba3e78b" title="Lerp: linera interpolation between colors. ">HelperGl::lerp</a>(<a class="code" href="class_animation_1_1_particle_system_1_1_modifier_color_life_time.html#ad10f3aaa39ffc15fb505043d912f0031">m_startColor</a>, <a class="code" href="class_animation_1_1_particle_system_1_1_modifier_color_life_time.html#a658e4ad5801cc8f12dd591212db590db">m_endColor</a>, timePercent) ;</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;            }</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        };</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;        <span class="comment">// -------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;        <span class="comment">// Some death functions compatibles with the addDeathFunction method</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;        <span class="comment">// -------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;</div>
<div class="line"><a name="l00356"></a><span class="lineno"><a class="code" href="class_animation_1_1_particle_system.html#aa257f34465351029ed42971950500555">  356</a></span>&#160;        <span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="class_animation_1_1_particle_system.html#aa257f34465351029ed42971950500555" title="Provoques the death of a particle if its life time reaches its end. ">deathLifeTime</a>(<span class="keyword">const</span> <a class="code" href="class_animation_1_1_particle.html" title="Particle class. ">Particle</a> &amp; particle)</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;        {</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;            <span class="keywordflow">return</span> particle.<a class="code" href="class_animation_1_1_particle.html#ae2e814a41aa28b537e979617a5c956c3" title="The time elapsed since the birth of the particle. ">m_lifeTime</a> &gt;= particle.<a class="code" href="class_animation_1_1_particle.html#ad5e599c37c42c2b7febb28d9d0b3801e" title="The life time limit of the particle. ">m_lifeTimeLimit</a> ;</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;        }</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;        <span class="comment">// ---------------------------</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        <span class="comment">// Some emitters</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;        <span class="comment">// ---------------------------  </span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;</div>
<div class="line"><a name="l00373"></a><span class="lineno"><a class="code" href="class_animation_1_1_particle_system_1_1_rate_emitter_base.html">  373</a></span>&#160;        <span class="keyword">class </span><a class="code" href="class_animation_1_1_particle_system_1_1_rate_emitter_base.html" title="Helper class for emitters with emission rate. ">RateEmitterBase</a></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;        {</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;        <span class="keyword">protected</span>:</div>
<div class="line"><a name="l00376"></a><span class="lineno"><a class="code" href="class_animation_1_1_particle_system_1_1_rate_emitter_base.html#ac38bd288b481246230762025f1b23069">  376</a></span>&#160;            <span class="keywordtype">float</span>   <a class="code" href="class_animation_1_1_particle_system_1_1_rate_emitter_base.html#ac38bd288b481246230762025f1b23069">m_emissionRate</a> ;</div>
<div class="line"><a name="l00377"></a><span class="lineno"><a class="code" href="class_animation_1_1_particle_system_1_1_rate_emitter_base.html#aba874a86b59da45140506dc964884f63">  377</a></span>&#160;            <span class="keywordtype">float</span>   <a class="code" href="class_animation_1_1_particle_system_1_1_rate_emitter_base.html#aba874a86b59da45140506dc964884f63">m_dateFraction</a> ;</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;</div>
<div class="line"><a name="l00391"></a><span class="lineno"><a class="code" href="class_animation_1_1_particle_system_1_1_rate_emitter_base.html#a695c2db0f3a25390503fc3c4a6d878a6">  391</a></span>&#160;            <span class="keywordtype">size_t</span> <a class="code" href="class_animation_1_1_particle_system_1_1_rate_emitter_base.html#a695c2db0f3a25390503fc3c4a6d878a6" title="Returns the number of particles that should be emitted at this time. ">numberOfParticles</a>(<span class="keywordtype">float</span> dt)</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;            {</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;                <a class="code" href="class_animation_1_1_particle_system_1_1_rate_emitter_base.html#aba874a86b59da45140506dc964884f63">m_dateFraction</a> += dt ;</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;                <span class="keywordtype">size_t</span> number = (size_t)(<a class="code" href="class_animation_1_1_particle_system_1_1_rate_emitter_base.html#aba874a86b59da45140506dc964884f63">m_dateFraction</a> * <a class="code" href="class_animation_1_1_particle_system_1_1_rate_emitter_base.html#ac38bd288b481246230762025f1b23069">m_emissionRate</a>) ;</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;                <a class="code" href="class_animation_1_1_particle_system_1_1_rate_emitter_base.html#aba874a86b59da45140506dc964884f63">m_dateFraction</a> -= (float)number/(<span class="keywordtype">float</span>)<a class="code" href="class_animation_1_1_particle_system_1_1_rate_emitter_base.html#ac38bd288b481246230762025f1b23069">m_emissionRate</a> ;</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;                <span class="keywordflow">return</span> number ;</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;            }</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;</div>
<div class="line"><a name="l00409"></a><span class="lineno"><a class="code" href="class_animation_1_1_particle_system_1_1_rate_emitter_base.html#a8e6337cb8a31baaa73e301ee701f7f49">  409</a></span>&#160;            <a class="code" href="class_animation_1_1_particle_system_1_1_rate_emitter_base.html#a8e6337cb8a31baaa73e301ee701f7f49" title="Constructor. ">RateEmitterBase</a>(<span class="keywordtype">float</span> emissionRate)</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;                : <a class="code" href="class_animation_1_1_particle_system_1_1_rate_emitter_base.html#ac38bd288b481246230762025f1b23069">m_emissionRate</a>(emissionRate)</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;            {}</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;        };</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;</div>
<div class="line"><a name="l00422"></a><span class="lineno"><a class="code" href="class_animation_1_1_particle_system_1_1_limited_emitter_base.html">  422</a></span>&#160;        <span class="keyword">class </span><a class="code" href="class_animation_1_1_particle_system_1_1_limited_emitter_base.html" title="Helper class for emitter with a limited number of particles. ">LimitedEmitterBase</a></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;        {</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;        <span class="keyword">protected</span>:</div>
<div class="line"><a name="l00425"></a><span class="lineno"><a class="code" href="class_animation_1_1_particle_system_1_1_limited_emitter_base.html#a0337a3768c559a5c8425da75b4345ba1">  425</a></span>&#160;            <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="class_animation_1_1_particle_system_1_1_limited_emitter_base.html#a0337a3768c559a5c8425da75b4345ba1">m_remainingParticles</a> ;</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;</div>
<div class="line"><a name="l00427"></a><span class="lineno"><a class="code" href="class_animation_1_1_particle_system_1_1_limited_emitter_base.html#a0e8bd059c682372c0efc301e10f31736">  427</a></span>&#160;            <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="class_animation_1_1_particle_system_1_1_limited_emitter_base.html#a0e8bd059c682372c0efc301e10f31736">remainingParticles</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;<span class="keyword">            </span>{</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="class_animation_1_1_particle_system_1_1_limited_emitter_base.html#a0337a3768c559a5c8425da75b4345ba1">m_remainingParticles</a> ;</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;            }</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;</div>
<div class="line"><a name="l00432"></a><span class="lineno"><a class="code" href="class_animation_1_1_particle_system_1_1_limited_emitter_base.html#aabca8347cdf32a1220d5025bf230aefa">  432</a></span>&#160;            <span class="keywordtype">void</span> <a class="code" href="class_animation_1_1_particle_system_1_1_limited_emitter_base.html#aabca8347cdf32a1220d5025bf230aefa">removeEmitted</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> number) </div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;            {</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;                <a class="code" href="class_animation_1_1_particle_system_1_1_limited_emitter_base.html#a0337a3768c559a5c8425da75b4345ba1">m_remainingParticles</a> -= ::std::min(<a class="code" href="class_animation_1_1_particle_system_1_1_limited_emitter_base.html#a0337a3768c559a5c8425da75b4345ba1">m_remainingParticles</a>, number) ;</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;            }</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;</div>
<div class="line"><a name="l00437"></a><span class="lineno"><a class="code" href="class_animation_1_1_particle_system_1_1_limited_emitter_base.html#ab2ae4c4980a85dcdbecc0e6987085816">  437</a></span>&#160;            <span class="keywordtype">bool</span> <a class="code" href="class_animation_1_1_particle_system_1_1_limited_emitter_base.html#ab2ae4c4980a85dcdbecc0e6987085816">isEmpty</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;<span class="keyword">            </span>{</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="class_animation_1_1_particle_system_1_1_limited_emitter_base.html#a0337a3768c559a5c8425da75b4345ba1">m_remainingParticles</a>==0 ;</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;            }</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;</div>
<div class="line"><a name="l00442"></a><span class="lineno"><a class="code" href="class_animation_1_1_particle_system_1_1_limited_emitter_base.html#af251279597f055e3fa9d20a6f95ae2bc">  442</a></span>&#160;            <a class="code" href="class_animation_1_1_particle_system_1_1_limited_emitter_base.html#af251279597f055e3fa9d20a6f95ae2bc">LimitedEmitterBase</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> particleNumber)</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;                : <a class="code" href="class_animation_1_1_particle_system_1_1_limited_emitter_base.html#a0337a3768c559a5c8425da75b4345ba1">m_remainingParticles</a>(particleNumber)</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;            {}</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;        };</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;</div>
<div class="line"><a name="l00455"></a><span class="lineno"><a class="code" href="class_animation_1_1_particle_system_1_1_ball_flow_emitter.html">  455</a></span>&#160;        <span class="keyword">class </span><a class="code" href="class_animation_1_1_particle_system_1_1_ball_flow_emitter.html" title="Ball flow emitter. ">BallFlowEmitter</a> : <a class="code" href="class_animation_1_1_particle_system_1_1_rate_emitter_base.html" title="Helper class for emitters with emission rate. ">RateEmitterBase</a></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;        {</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;        <span class="keyword">protected</span>:</div>
<div class="line"><a name="l00458"></a><span class="lineno"><a class="code" href="class_animation_1_1_particle_system_1_1_ball_flow_emitter.html#ae15bdd15018233152306a07f5c90a4c6">  458</a></span>&#160;            <a class="code" href="class_math_1_1_vector.html">Math::Vector3f</a> <a class="code" href="class_animation_1_1_particle_system_1_1_ball_flow_emitter.html#ae15bdd15018233152306a07f5c90a4c6">m_center</a> ;</div>
<div class="line"><a name="l00459"></a><span class="lineno"><a class="code" href="class_animation_1_1_particle_system_1_1_ball_flow_emitter.html#aa26c26bb9a88a9611d67d878d852c429">  459</a></span>&#160;            <span class="keywordtype">float</span> <a class="code" href="class_animation_1_1_particle_system_1_1_ball_flow_emitter.html#aa26c26bb9a88a9611d67d878d852c429">m_radius</a> ;</div>
<div class="line"><a name="l00460"></a><span class="lineno"><a class="code" href="class_animation_1_1_particle_system_1_1_ball_flow_emitter.html#ad9ba0831da8c4d85cbdb34009060743a">  460</a></span>&#160;            <a class="code" href="class_math_1_1_interval.html">Math::Interval&lt;float&gt;</a> <a class="code" href="class_animation_1_1_particle_system_1_1_ball_flow_emitter.html#ad9ba0831da8c4d85cbdb34009060743a">m_speed</a> ;</div>
<div class="line"><a name="l00461"></a><span class="lineno"><a class="code" href="class_animation_1_1_particle_system_1_1_ball_flow_emitter.html#ac1b15b6adb4975178f0f601499e61d72">  461</a></span>&#160;            <a class="code" href="class_math_1_1_interval.html">Math::Interval&lt;float&gt;</a> <a class="code" href="class_animation_1_1_particle_system_1_1_ball_flow_emitter.html#ac1b15b6adb4975178f0f601499e61d72">m_lifeTime</a> ;</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;        <span class="keyword">public</span>:</div>
<div class="line"><a name="l00464"></a><span class="lineno"><a class="code" href="class_animation_1_1_particle_system_1_1_ball_flow_emitter.html#ac3e67976ea624e71f1878124dca1f682">  464</a></span>&#160;            <a class="code" href="class_animation_1_1_particle_system_1_1_ball_flow_emitter.html#ac3e67976ea624e71f1878124dca1f682">BallFlowEmitter</a>(<a class="code" href="class_math_1_1_vector.html">Math::Vector3f</a> <span class="keyword">const</span> &amp; center, <span class="keywordtype">float</span> radius, <span class="keywordtype">float</span> emissionRate,</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;                            <a class="code" href="class_math_1_1_interval.html">Math::Interval&lt;float&gt;</a> <span class="keyword">const</span> &amp; speed, <a class="code" href="class_math_1_1_interval.html">Math::Interval&lt;float&gt;</a> <span class="keyword">const</span> &amp; lifeTime)</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;                : <a class="code" href="class_animation_1_1_particle_system_1_1_rate_emitter_base.html" title="Helper class for emitters with emission rate. ">RateEmitterBase</a>(emissionRate), <a class="code" href="class_animation_1_1_particle_system_1_1_ball_flow_emitter.html#ae15bdd15018233152306a07f5c90a4c6">m_center</a>(center), <a class="code" href="class_animation_1_1_particle_system_1_1_ball_flow_emitter.html#aa26c26bb9a88a9611d67d878d852c429">m_radius</a>(radius), <a class="code" href="class_animation_1_1_particle_system_1_1_ball_flow_emitter.html#ad9ba0831da8c4d85cbdb34009060743a">m_speed</a>(speed), <a class="code" href="class_animation_1_1_particle_system_1_1_ball_flow_emitter.html#ac1b15b6adb4975178f0f601499e61d72">m_lifeTime</a>(lifeTime)</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;            {}</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;</div>
<div class="line"><a name="l00489"></a><span class="lineno"><a class="code" href="class_animation_1_1_particle_system_1_1_ball_flow_emitter.html#a3624a5975787f88f1c860e1148f8266f">  489</a></span>&#160;            <span class="keywordtype">bool</span> <a class="code" href="class_animation_1_1_particle_system_1_1_ball_flow_emitter.html#a3624a5975787f88f1c860e1148f8266f">operator() </a>(<a class="code" href="class_animation_1_1_particle_system.html#a52cb920384a4da3484b376bd9f94efb0">ParticleInserter</a> inserter, <span class="keywordtype">size_t</span> productionLimit, <span class="keywordtype">float</span> dt)</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;            {</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;                <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> toEmit = ::std::min(productionLimit, <a class="code" href="class_animation_1_1_particle_system_1_1_rate_emitter_base.html#a695c2db0f3a25390503fc3c4a6d878a6" title="Returns the number of particles that should be emitted at this time. ">numberOfParticles</a>(dt)) ;</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;                <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> cpt=0 ; cpt&lt;toEmit ; ++cpt)</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;                {</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;                    <a class="code" href="class_math_1_1_vector.html">Math::Vector3f</a> direction = <a class="code" href="class_math_1_1_sampler.html#ae216a5a8f0ec34e6db1ba1e71db6b955" title="Returns a random point in the unit ball. Distribution is uniform. ">Math::Sampler::sphere</a>() ;</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;                    <a class="code" href="class_math_1_1_vector.html">Math::Vector3f</a> position = <a class="code" href="class_animation_1_1_particle_system_1_1_ball_flow_emitter.html#ae15bdd15018233152306a07f5c90a4c6">m_center</a>+direction*<a class="code" href="class_animation_1_1_particle_system_1_1_ball_flow_emitter.html#aa26c26bb9a88a9611d67d878d852c429">m_radius</a> ;</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;                    <a class="code" href="class_math_1_1_vector.html">Math::Vector3f</a> speed = direction*<a class="code" href="class_animation_1_1_particle_system_1_1_ball_flow_emitter.html#ad9ba0831da8c4d85cbdb34009060743a">m_speed</a>.<a class="code" href="class_math_1_1_interval.html#aeaaabe770bab2705877a628b7a109f26" title="Returns a random value lying in the interval. ">random</a>() ;</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;                    <a class="code" href="class_animation_1_1_particle.html" title="Particle class. ">Particle</a> current ; <span class="comment">//= ParticleInitializer(position) ;</span></div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;                    current.<a class="code" href="class_animation_1_1_particle.html#a077543117f298541ec4c01ccfa99c275" title="The position of the particle. ">m_position</a> = position ;</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;                    current.<a class="code" href="class_animation_1_1_particle.html#a3642d8ff1ec3dbfa5afb4c86636375c1" title="The speed of the particle. ">m_speed</a> = speed ;</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;                    current.<a class="code" href="class_animation_1_1_particle.html#ad5e599c37c42c2b7febb28d9d0b3801e" title="The life time limit of the particle. ">m_lifeTimeLimit</a> = <a class="code" href="class_animation_1_1_particle_system_1_1_ball_flow_emitter.html#ac1b15b6adb4975178f0f601499e61d72">m_lifeTime</a>.<a class="code" href="class_math_1_1_interval.html#aeaaabe770bab2705877a628b7a109f26" title="Returns a random value lying in the interval. ">random</a>();</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;                    current.<a class="code" href="class_animation_1_1_particle.html#a2844d1cf6660bedaca4e5afdd1a68987" title="The color of the particle. ">m_color</a> = <a class="code" href="class_helper_gl_1_1_color.html" title="RGBA color. ">HelperGl::Color</a>(1.0f,1.0f,1.0f);</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;                    (*inserter) = current ;</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;                    ++inserter; </div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;                }</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;                <span class="keywordflow">return</span> true ;</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;            }</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;        };</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    };</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;}</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;<span class="preprocessor">#endif</span></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Apr 1 2016 12:11:39 for Rendering and Animation Platform by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.4
</small></address>
</body>
</html>
